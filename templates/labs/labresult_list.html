{% extends 'base/base.html' %}
{% block title %}Lab Results{% endblock %}
{% block content %}
<h2>Lab Results</h2>
<ul>
  {% for result in results %}
    <li>
      <a href="{% url 'labresult_detail' result.pk %}">{{ result.patient }} - {{ result.created_at }}</a><br>{{ result.result|truncatewords:20 }}
      {% if perms.labs.change_labresult %}
        <a href="{% url 'labresult_edit' result.pk %}">Edit</a>
      {% endif %}
      {% if perms.labs.delete_labresult %}
        <a href="#" class="modal-trigger" data-target="delete-modal-{{ result.pk }}">Delete</a>
        <div id="delete-modal-{{ result.pk }}" class="modal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.5);z-index:1000;">
          <div style="background:#fff;padding:2rem;margin:10vh auto;max-width:400px;position:relative;">
            <button class="close" style="position:absolute;top:1rem;right:1rem;">&times;</button>
            <h3>Delete Lab Result</h3>
            <p>Are you sure you want to delete this lab result for {{ result.patient }}?</p>
            <form method="post" action="{% url 'labresult_delete' result.pk %}">
              {% csrf_token %}
              <button type="submit">Yes, delete</button>
              <button type="button" class="close">Cancel</button>
            </form>
          </div>
        </div>
      {% endif %}
    {% block extra_js %}
    <script src="/static/js/modal.js"></script>
    {% endblock %}
    </li>
  {% empty %}
    <li>No lab results found.</li>
  {% endfor %}
</ul>
{% endblock %}
